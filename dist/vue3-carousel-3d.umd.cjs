(function(l,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(l=typeof globalThis<"u"?globalThis:l||self,i(l["vue3-carousel-3d"]={},l.Vue))})(this,function(l,i){"use strict";const c=i.defineComponent({emits:["goPrev","goNext"],props:{width:{type:Number,default:50},height:{type:Number,default:60},prevHtml:{type:String,default:"&lsaquo;"},nextHtml:{type:String,default:"&rsaquo;"},isPrevPossible:{type:Boolean,required:!0},isNextPossible:{type:Boolean,required:!0}}}),d=(t,e)=>{const s=t.__vccOpts||t;for(const[n,o]of e)s[n]=o;return s},f={class:"carousel-3d-controls"},m=["innerHTML"],g=["innerHTML"];function b(t,e,s,n,o,h){return i.openBlock(),i.createElementBlock("div",f,[i.createElementVNode("a",{href:"#",class:i.normalizeClass(["prev",{disabled:!t.isPrevPossible}]),onClick:e[0]||(e[0]=i.withModifiers(a=>t.$emit("goPrev"),["prevent"])),style:i.normalizeStyle(`width: ${t.width}px; height: ${t.height}px; line-height: ${t.height}px;`),"aria-label":"Previous slide"},[i.createElementVNode("span",{innerHTML:t.prevHtml},null,8,m)],6),i.createElementVNode("a",{href:"#",class:i.normalizeClass(["next",{disabled:!t.isNextPossible}]),onClick:e[1]||(e[1]=i.withModifiers(a=>t.$emit("goNext"),["prevent"])),style:i.normalizeStyle(`width: ${t.width}px; height: ${t.height}px; line-height: ${t.height}px;`),"aria-label":"Next slide"},[i.createElementVNode("span",{innerHTML:t.nextHtml},null,8,g)],6)])}const y=d(c,[["render",b],["__scopeId","data-v-717c3828"]]),I=i.defineComponent({components:{Controls:y},props:{count:{type:Number,default:0},perspective:{type:Number,default:35},display:{type:Number,default:5},loop:{type:Boolean,default:!0},animationSpeed:{type:Number,default:500},dir:{type:String,default:"rtl"},width:{type:Number,default:360},height:{type:Number,default:270},border:{type:Number,default:1},space:{type:[Number,String],default:"auto"},startIndex:{type:Number,default:0},clickable:{type:Boolean,default:!0},disable3d:{type:Boolean,default:!1},minSwipeDistance:{type:Number,default:10},inverseScaling:{type:Number,default:300},controlsVisible:{type:Boolean,default:!1},controlsPrevHtml:{type:String,default:"&lsaquo;"},controlsNextHtml:{type:String,default:"&rsaquo;"},controlsWidth:{type:Number,default:50},controlsHeight:{type:Number,default:50},bias:{type:String,default:"left"},onMainSlideClick:{type:Function},oneDirectional:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},autoplayTimeout:{type:Number,default:2e3},autoplayHoverPause:{type:Boolean,default:!0}},data(){return{viewport:0,currentIndex:0,total:0,dragOffsetX:0,dragStartX:0,dragOffsetY:0,dragStartY:0,mousedown:!1,zIndex:998,mutationObserver:new MutationObserver(()=>{}),autoplayInterval:0}},destroyed(){this.pauseAutoplay(),this.$el.removeEventListener("mouseenter",this.pauseAutoplay),this.$el.removeEventListener("mouseleave",this.startAutoplay)},watch:{count(){this.computeData()}},computed:{isLastSlide(){return this.currentIndex===this.total-1},isFirstSlide(){return this.currentIndex===0},isNextPossible(){return!(!this.loop&&this.isLastSlide)},isPrevPossible(){return!(!this.loop&&this.isFirstSlide)},slideWidth(){const t=this.viewport,e=this.width+this.border*2;return t<e&&typeof window>"u"?t:e},slideHeight(){const t=this.width+this.border*2,e=this.height+this.border*2,s=this.calculateAspectRatio(t,e);return this.slideWidth/s},visible(){return this.display>this.total?this.total:this.display},hasHiddenSlides(){return this.total>this.visible},leftIndices(){let t=(this.visible-1)/2;t=this.bias.toLowerCase()==="left"?Math.ceil(t):Math.floor(t);const e=[];for(let s=1;s<=t;s++)e.push(this.dir==="ltr"?(this.currentIndex+s)%this.total:(this.currentIndex-s)%this.total);return e},rightIndices(){let t=(this.visible-1)/2;t=this.bias.toLowerCase()==="right"?Math.ceil(t):Math.floor(t);const e=[];for(let s=1;s<=t;s++)e.push(this.dir==="ltr"?(this.currentIndex-s)%this.total:(this.currentIndex+s)%this.total);return e},leftOutIndex(){let t=(this.visible-1)/2;return t=this.bias.toLowerCase()==="left"?Math.ceil(t):Math.floor(t),t++,this.dir==="ltr"?this.total-this.currentIndex-t<=0?-(this.total-this.currentIndex-t):this.currentIndex+t:this.currentIndex-t},rightOutIndex(){let t=(this.visible-1)/2;return t=this.bias.toLowerCase()==="right"?Math.ceil(t):Math.floor(t),t++,this.dir==="ltr"?this.currentIndex-t:this.total-this.currentIndex-t<=0?-(this.total-this.currentIndex-t):this.currentIndex+t}},methods:{goNext(){this.isNextPossible&&(this.isLastSlide?this.goSlide(0):this.goSlide(this.currentIndex+1))},goPrev(){this.isPrevPossible&&(this.isFirstSlide?this.goSlide(this.total-1):this.goSlide(this.currentIndex-1))},goSlide(t){this.currentIndex=t<0||t>this.total-1?0:t,this.isLastSlide&&this.$emit("last-slide",this.currentIndex),this.$emit("before-slide-change",this.currentIndex),setTimeout(()=>this.animationEnd(),this.animationSpeed)},goFar(t){let e=t===this.total-1&&this.isFirstSlide?-1:t-this.currentIndex;this.isLastSlide&&t===0&&(e=1);const s=e<0?-e:e;let n=0,o=0;for(;o<s;)o+=1,setTimeout(()=>e<0?this.goPrev():this.goNext(),s===1?0:n),n+=this.animationSpeed/s},animationEnd(){this.$emit("after-slide-change",this.currentIndex)},handleMouseup(){this.mousedown=!1,this.dragOffsetX=0,this.dragOffsetY=0},handleMousedown(t){t.touches?t=t.touches[0]:t.preventDefault(),this.mousedown=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY},handleMousemove(t){if(!this.mousedown)return;t.touches&&(t=t.touches[0]);const e=t.clientX,s=t.clientY,n=this.dragStartX-e,o=this.dragStartY-s;this.dragOffsetX=n,this.dragOffsetY=o,!(Math.abs(this.dragOffsetY)>Math.abs(this.dragOffsetX))&&(this.dragOffsetX>this.minSwipeDistance?(this.handleMouseup(),this.goNext()):this.dragOffsetX<-this.minSwipeDistance&&(this.handleMouseup(),this.goPrev()))},attachMutationObserver(){const t=window.MutationObserver;if(t){const e={attributes:!0,childList:!0,characterData:!0};this.mutationObserver=new t(()=>{this.$nextTick(()=>{this.computeData()})}),this.$el&&this.mutationObserver.observe(this.$el,e)}},detachMutationObserver(){this.mutationObserver&&this.mutationObserver.disconnect()},getSlideCount(){let t=0;const e=this.$refs.slider;return e&&e.children&&(t=e.children.length),t},calculateAspectRatio(t,e){return Math.min(t/e)},computeData(t){this.total=this.getSlideCount(),(t||this.currentIndex>=this.total)&&(this.currentIndex=this.startIndex>this.total-1?this.total-1:this.startIndex),this.viewport=this.$el.clientWidth},setSize(){this.$el.style.cssText+="height:"+this.slideHeight+"px;",this.$el.childNodes[0].style.cssText+="width:"+this.slideWidth+"px; height:"+this.slideHeight+"px;"},pauseAutoplay(){this.autoplayInterval&&clearInterval(this.autoplayInterval)},startAutoplay(){this.autoplay&&(this.autoplayInterval=setInterval(()=>{this.dir==="ltr"?this.goPrev():this.goNext()},this.autoplayTimeout))}},mounted(){this.computeData(!0),this.attachMutationObserver(),window.addEventListener("resize",this.setSize),this.autoplayHoverPause&&(this.$el.addEventListener("mouseenter",this.pauseAutoplay),this.$el.addEventListener("mouseleave",this.startAutoplay),this.startAutoplay())},beforeUnmount(){this.detachMutationObserver(),window.removeEventListener("resize",this.setSize)}});function v(t,e,s,n,o,h){const a=i.resolveComponent("Controls");return i.openBlock(),i.createElementBlock("div",{class:"carousel-3d-container",style:i.normalizeStyle({height:t.slideHeight+"px"}),onTouchstart:e[0]||(e[0]=(...r)=>t.handleMousedown&&t.handleMousedown(...r)),onTouchend:e[1]||(e[1]=(...r)=>t.handleMouseup&&t.handleMouseup(...r)),onTouchmove:e[2]||(e[2]=(...r)=>t.handleMousemove&&t.handleMousemove(...r)),onMousedown:e[3]||(e[3]=(...r)=>t.handleMousedown&&t.handleMousedown(...r)),onMouseup:e[4]||(e[4]=(...r)=>t.handleMouseup&&t.handleMouseup(...r)),onMousemove:e[5]||(e[5]=(...r)=>t.handleMousemove&&t.handleMousemove(...r))},[i.createElementVNode("div",{ref:"slider",class:"carousel-3d-slider",style:i.normalizeStyle({width:t.slideWidth+"px",height:t.slideHeight+"px"})},[i.renderSlot(t.$slots,"default",{},void 0,!0)],4),t.controlsVisible?(i.openBlock(),i.createBlock(a,{key:0,"next-html":t.controlsNextHtml,"prev-html":t.controlsPrevHtml,width:t.controlsWidth,height:t.controlsHeight,"is-prev-possible":t.isPrevPossible,"is-next-possible":t.isNextPossible,onGoPrev:t.goPrev,onGoNext:t.goNext},null,8,["next-html","prev-html","width","height","is-prev-possible","is-next-possible","onGoPrev","onGoNext"])):i.createCommentVNode("",!0)],36)}const u=d(I,[["render",v],["__scopeId","data-v-326cf73d"]]),x=i.defineComponent({props:{index:{type:Number}},data(){return{parent:this.$parent,styles:void 0,zIndex:999}},computed:{isCurrent(){return this.index===this.parent.currentIndex},leftIndex(){return this.parent.oneDirectional&&this.getSideIndex(this.parent.leftIndices)>this.parent.currentIndex-1?-1:this.getSideIndex(this.parent.leftIndices)},rightIndex(){return this.parent.oneDirectional&&this.getSideIndex(this.parent.rightIndices)>this.parent.total-this.parent.currentIndex-2?-1:this.getSideIndex(this.parent.rightIndices)},slideStyle(){let t=this.baseStyle();if(!this.isCurrent){const e=this.leftIndex,s=this.rightIndex;(s>=0||e>=0)&&(t=s>=0?this.calculatePosition(s,!0,this.zIndex):this.calculatePosition(e,!1,this.zIndex),t=Object.assign(t,{opacity:1,visibility:"visible"})),this.parent.hasHiddenSlides&&(this.matchIndex(this.parent.leftOutIndex)?t=this.calculatePosition(this.parent.leftIndices.length-1,!1,this.zIndex):this.matchIndex(this.parent.rightOutIndex)&&(t=this.calculatePosition(this.parent.rightIndices.length-1,!0,this.zIndex)))}return t},computedClasses(){return{[`left-${this.leftIndex+1}`]:this.leftIndex>=0,[`right-${this.rightIndex+1}`]:this.rightIndex>=0,current:this.isCurrent}}},methods:{getSideIndex(t){let e=-1;return t.forEach((s,n)=>{this.matchIndex(s)&&(e=n)}),e},matchIndex(t){return t>=0?this.index===t:this.parent.total+t===this.index},baseStyle(){return{"border-width":this.parent.border+"px",width:this.parent.slideWidth+"px",height:this.parent.slideHeight+"px",transition:" transform "+this.parent.animationSpeed+"ms,                opacity "+this.parent.animationSpeed+"ms,                visibility "+this.parent.animationSpeed+"ms"}},calculatePosition(t,e,s){const n=this.baseStyle(),o=this.parent.disable3d?0:parseInt(this.parent.inverseScaling)+(t+1)*100,h=this.parent.disable3d?0:parseInt(this.parent.perspective),a=this.parent.space==="auto"?(t+1)*(this.parent.width/1.5):(t+1)*this.parent.space,r=e?"translateX("+a+"px) translateZ(-"+o+"px) rotateY(-"+h+"deg)":"translateX(-"+a+"px) translateZ(-"+o+"px) rotateY("+h+"deg)",M=this.parent.space==="auto"?0:(t+1)*this.parent.space;return Object.assign(n,{transform:r,top:M,zIndex:s-(Math.abs(t)+1)})},goTo(){if(!this.isCurrent)this.parent.clickable===!0&&this.parent.goFar(this.index);else{const{index:t}=this;this.parent.onMainSlideClick({index:t})}}}});function S(t,e,s,n,o,h){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["carousel-3d-slide",t.computedClasses]),style:i.normalizeStyle(t.slideStyle),onClick:e[0]||(e[0]=a=>t.goTo())},[i.renderSlot(t.$slots,"default",{index:t.index,isCurrent:t.isCurrent,leftIndex:t.leftIndex,rightIndex:t.rightIndex},void 0,!0)],6)}const p=d(x,[["render",S],["__scopeId","data-v-f75c401f"]]),w={install(t){t.component("Carousel3d",u),t.component("Slide",p)}};l.Carousel3d=u,l.Carousel3dPlugin=w,l.Slide=p,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
